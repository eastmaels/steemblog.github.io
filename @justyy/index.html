
<!DOCTYPE html>
<html lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
<title>justyy</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">









<link rel="icon" href="https://www.easyicon.net/api/resizeApi.php?id=1185564&size=32">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-dark.css">


    
    
    
    <style>body>.footer,body>.navbar,body>.section{opacity:0}</style>
    

    
    
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">
    

    
    

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">


    
    
    
    




    
    

    
    
    
    

    
    

<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

    
    
    

    
    
    


<link rel="stylesheet" href="/@justyy/css/style.css">

<link rel="stylesheet" href="/@justyy/css/bundle.css"></head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/@justyy/">
            
                <img src="https://avatars0.githubusercontent.com/u/50857551?s=200&v=4" alt="justyy" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active" href="/@justyy/">Home</a>
                
                <a class="navbar-item" href="/@justyy/archives">Archives</a>
                
                <a class="navbar-item" href="/@justyy/categories">Categories</a>
                
                <a class="navbar-item" href="/@justyy/tags">Tags</a>
                
                <a class="navbar-item" href="/@justyy/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                
                
                <a class="navbar-item search" title="Search" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>

    
    <section class="section">
        <div class="container">
            <div class="columns">
                





<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        <div class="card widget">
  <div class="card-content">
    <div id="widget-profile" data-pjax="/@justyy/widgets/profile.html" style="position: relative; width: 100%; display: block;"></div>
  </div>
</div>



    
        <div class="card widget">
  <div class="card-content">
    <div id="widget-category" data-pjax="/@justyy/widgets/category.html" style="position: relative; width: 100%; display: block;"></div>
  </div>
</div>



    
        <div class="card widget">
  <div class="card-content">
    <div id="widget-tagcloud" data-pjax="/@justyy/widgets/tagcloud.html" style="position: relative; width: 100%; display: block;"></div>
  </div>
</div>



    
        <div class="card widget">
  <div class="card-content">
    <div id="widget-tag" data-pjax="/@justyy/widgets/tag.html" style="position: relative; width: 100%; display: block;"></div>
  </div>
</div>



    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            

        
            <div class="card widget">
  <div class="card-content">
    <div id="widget-recent_posts" data-pjax="/@justyy/widgets/recent_posts.html" style="position: relative; width: 100%; display: block;"></div>
  </div>
</div>



        
            <div class="card widget">
  <div class="card-content">
    <div id="widget-archive" data-pjax="/@justyy/widgets/archive.html" style="position: relative; width: 100%; display: block;"></div>
  </div>
</div>



        
        </div>
    
</div>


                





<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        

    
        <div class="card widget">
  <div class="card-content">
    <div id="widget-recent_posts" data-pjax="/@justyy/widgets/recent_posts.html" style="position: relative; width: 100%; display: block;"></div>
  </div>
</div>



    
        <div class="card widget">
  <div class="card-content">
    <div id="widget-archive" data-pjax="/@justyy/widgets/archive.html" style="position: relative; width: 100%; display: block;"></div>
  </div>
</div>



    
    
</div>


                <script src="/@justyy/js/pjax-widget.js"></script>

                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    <div class="card">
    
    <div class="card-image">
        <a href="/@justyy/the-customjson-inconsistent-format-increase-the-complexity/" class="image is-7by1">
            <img class="thumbnail" src="https://steemyy.com/images/vote-for-justyy.jpg" alt="The custom_json inconsistent format increase the complexity">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-06-15T18:08:18.000Z">2020-06-15</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/@justyy/categories/codeonsteem/">codeonsteem</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 330 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/@justyy/the-customjson-inconsistent-format-increase-the-complexity/">The custom_json inconsistent format increase the complexity</a>
            
        </h1>
        <div class="content">
            <p>I have been wanting to make a few tools that require pre-processing the custom_json fields. however the script gets exceptions from time to time due to the inconsistent format of the custom_json.</p>
<p>For example,  sometimes, I see this format:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">{&apos;required_auths&apos;: [], &apos;id&apos;: &apos;follow&apos;, &apos;required_posting_auths&apos;: [&apos;steemit&apos;], &apos;json&apos;: &apos;[&quot;follow&quot;, {&quot;follower&quot;:&quot;steemit&quot;,&quot;following&quot;:&quot;steem&quot;,&quot;what&quot;:[&quot;posts&quot;]}]&apos;}</span><br></pre></td></tr></tbody></table></figure>
<p>And sometimes this:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">{&apos;required_auths&apos;: [], &apos;id&apos;: &apos;follow&apos;, &apos;required_posting_auths&apos;: [&apos;steemit&apos;], &apos;json&apos;: &apos;{&quot;follower&quot;:&quot;steemit&quot;,&quot;following&quot;:&quot;steem&quot;,&quot;what&quot;:[&quot;posts&quot;]}&apos;}</span><br></pre></td></tr></tbody></table></figure>
<p>I assume that it is up to the front-end to interpret if the format is correct. At this point,  the steem blockchain is just a public immutable database, and it has no idea what the JSON data means.</p>
<p>And also, this is worse:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">{&apos;required_auths&apos;: [], &apos;required_posting_auths&apos;: [&apos;jpphoto&apos;], &apos;id&apos;: &apos;follow&apos;, &apos;json&apos;: &apos;&quot;[\\&quot;reblog\\&quot;,{\\&quot;account\\&quot;:\\&quot;jpphoto\\&quot;,\\&quot;author\\&quot;:\\&quot;photovisions\\&quot;,\\&quot;permlink\\&quot;:\\&quot;travel-norway-27-autumn-in-sylan-mountains-snow-and-reindeers\\&quot;}]&quot;&apos;}</span><br></pre></td></tr></tbody></table></figure>
<p>First JSON decode gives a valid JSON string which needs to be decoded. It might be obvious for human to understand the data, but for computer programs, you would need to handle all these cases, at least, you would need to realise the incorrect format, discard it, and move on - instead of throwing exception and halt.</p>
<p>Life is hard.</p>
<hr>

<p>Every little helps! I hope this helps!</p>
<p><strong>Steem On!~</strong></p>
<h2 id="Reposted-to-Blog"><a href="#Reposted-to-Blog" class="headerlink" title="Reposted to Blog"></a>Reposted to <a href="https://helloacm.com/how-to-renew-the-free-ssl-certificates-nginx-server/" target="_blank" rel="noopener">Blog</a></h2><p>If you like my work, please consider voting for me, thanks!<br><a href="https://steemit.com/~witnesses" target="_blank" rel="noopener">https://steemit.com/~witnesses</a> type in <strong>justyy</strong> and click <strong><em>VOTE</em></strong><br><img src="https://steemyy.com/images/vote-for-justyy.jpg" alt=""></p>
<p><br><br><strong>Alternatively, you could <a href="https://steemyy.com/witness-voting/?witness=justyy&amp;action=proxy" target="_blank" rel="noopener">proxy to me</a>  if you are too lazy to vote!</strong></p>
<p>Also: you can vote me at the tool I made:  <a href="https://steemyy.com/witness-voting/?witness=justyy" target="_blank" rel="noopener">https://steemyy.com/witness-voting/?witness=justyy</a></p>
<h3 id="Visit-me-at-https-steemyy-com"><a href="#Visit-me-at-https-steemyy-com" class="headerlink" title="Visit me at:  https://steemyy.com"></a>Visit me at:  <a href="https://steemyy.com" target="_blank" rel="noopener">https://steemyy.com</a></h3><hr>
<p>This page is synchronized from the post: <a href="https://steemit.com/@justyy/the-customjson-inconsistent-format-increase-the-complexity" target="_blank" rel="noopener">&#x2018;The custom_json inconsistent format increase the complexity&#x2019;</a></p>
<script>document.querySelectorAll(".not-gallery-item").forEach(e=>{if(!e.dataset.src)return;const t=document.createElement("img");t.style="display:none !important;",t.src=e.dataset.src,t.addEventListener("error",()=>{t.remove(),e.style.color="inherit",e.style.backgroundImage="none",e.style.background="none"}),t.addEventListener("load",()=>{t.remove()}),document.body.appendChild(t)});</script>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-image">
        <a href="/@justyy/renewing-the-certificate-for-rpc-node-ngnix-server/" class="image is-7by1">
            <img class="thumbnail" src="https://cdn.steemitimages.com/DQmdvdJYUVdAKmqhunocLoxFre9WKV1NXgk2qAYPVqGGKTt/expiring-certificate.jpg" alt="Renewing the Certificate for RPC Node (Ngnix Server)">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-06-14T15:32:51.000Z">2020-06-14</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/@justyy/categories/whalepower/">whalepower</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 333 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/@justyy/renewing-the-certificate-for-rpc-node-ngnix-server/">Renewing the Certificate for RPC Node (Ngnix Server)</a>
            
        </h1>
        <div class="content">
            <p>The RPC Node <a href="https://api.justyy.com" target="_blank" rel="noopener">https://api.justyy.com</a> is expiring in 5 days.</p>
<p><img src="https://cdn.steemitimages.com/DQmdvdJYUVdAKmqhunocLoxFre9WKV1NXgk2qAYPVqGGKTt/expiring-certificate.jpg" alt="expiring-certificate.jpg"></p>
<p>Nowadays, you can easily get a free SSL certificate but you have to manually/automatically renew it every 90 days. </p>
<p>To apply for a certificate, you have to verify your domain - either by email of your domain, place a file on your server (which can be public accessed), or modify the DNS record.</p>
<p>If your DNS has configured CAA records, you need to remove them or add specific records allowing a SSL provider to issue the certificates on your domain.</p>
<p>Once the certificates are issued, you will see the following files:</p>
<p><img src="https://cdn.steemitimages.com/DQme6RxFy6kejuFjywNUACBP1NfvuVnQdSqGhGdmNKAemzV/certificates.jpg" alt="certificates.jpg"></p>
<p>You need to combine two CRTs into one:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat certificate.crt ca_bundle.crt &gt;&gt; certificate.crt</span><br></pre></td></tr></tbody></table></figure>
<p>Then in Nginx server, add the following in <code>server</code> block:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">listen   443;</span><br><span class="line">ssl    on;</span><br><span class="line">ssl_certificate    /etc/ssl/certificate.crt; </span><br><span class="line">ssl_certificate_key    /etc/ssl/private.key;</span><br></pre></td></tr></tbody></table></figure>
<p>Last but not least, restart the nginx server.</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/nginx restart</span><br><span class="line"># or </span><br><span class="line">sudo service nginx restart</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://cdn.steemitimages.com/DQmScSdwPbJe4eTNZz2dVv9uF6RnFu63bLTi71oze4yb4RT/image.png" alt="image.png"></p>
<hr>

<p>Every little helps! I hope this helps!</p>
<p><strong>Steem On!~</strong></p>
<h2 id="Reposted-to-Blog"><a href="#Reposted-to-Blog" class="headerlink" title="Reposted to Blog"></a>Reposted to <a href="https://helloacm.com/how-to-renew-the-free-ssl-certificates-nginx-server/" target="_blank" rel="noopener">Blog</a></h2><p>If you like my work, please consider voting for me, thanks!<br><a href="https://steemit.com/~witnesses" target="_blank" rel="noopener">https://steemit.com/~witnesses</a> type in <strong>justyy</strong> and click <strong><em>VOTE</em></strong><br><img src="https://steemyy.com/images/vote-for-justyy.jpg" alt=""></p>
<p><br><br><strong>Alternatively, you could <a href="https://steemyy.com/witness-voting/?witness=justyy&amp;action=proxy" target="_blank" rel="noopener">proxy to me</a>  if you are too lazy to vote!</strong></p>
<p>Also: you can vote me at the tool I made:  <a href="https://steemyy.com/witness-voting/?witness=justyy" target="_blank" rel="noopener">https://steemyy.com/witness-voting/?witness=justyy</a></p>
<h3 id="Visit-me-at-https-steemyy-com"><a href="#Visit-me-at-https-steemyy-com" class="headerlink" title="Visit me at:  https://steemyy.com"></a>Visit me at:  <a href="https://steemyy.com" target="_blank" rel="noopener">https://steemyy.com</a></h3><hr>
<p>This page is synchronized from the post: <a href="https://steemit.com/@justyy/renewing-the-certificate-for-rpc-node-ngnix-server" target="_blank" rel="noopener">&#x2018;Renewing the Certificate for RPC Node (Ngnix Server)&#x2019;</a></p>
<script>document.querySelectorAll(".not-gallery-item").forEach(e=>{if(!e.dataset.src)return;const t=document.createElement("img");t.style="display:none !important;",t.src=e.dataset.src,t.addEventListener("error",()=>{t.remove(),e.style.color="inherit",e.style.backgroundImage="none",e.style.background="none"}),t.addEventListener("load",()=>{t.remove()}),document.body.appendChild(t)});</script>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-image">
        <a href="/@justyy/design-how-to-solve-503-error-of-api-when-resources-are-not-available/" class="image is-7by1">
            <img class="thumbnail" src="https://steemyy.com/images/vote-for-justyy.jpg" alt="Design: How to Solve 503 Error of API when Resources are not available?">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-06-13T16:25:09.000Z">2020-06-13</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/@justyy/categories/codeonsteem/">codeonsteem</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 315 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/@justyy/design-how-to-solve-503-error-of-api-when-resources-are-not-available/">Design: How to Solve 503 Error of API when Resources are not available?</a>
            
        </h1>
        <div class="content">
            <p>The HTTP <a href="https://helloacm.com/how-to-respond-with-503-service-busy-to-requests-when-server-load-average-is-high/" target="_blank" rel="noopener">503 Error</a> indidicates the server is busy. It might be due to the fact that the servers are overloaded (high load average).</p>
<p>One of my API is designed to return 503 Error when the cached file is not available. It is designed as the follows:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (!is_file($file)) {</span><br><span class="line">    throw_503();</span><br><span class="line">    die();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The $file will be updated periodically e.g. every minute via <a href="https://helloacm.com/crontab-generator/" target="_blank" rel="noopener">Crontab</a>. When the OS is writing to that file, the <code>is_file</code> will return false because the file is in-use.</p>
<p>One way of solving this is to have multiple caching versions, to avoid the single point of failure. For example, if a file-1 is not available we can check for file-2. These two files should not be updated at the same time.</p>
<p>Another way to resolve this issue is to add a delay check (hacky solution), for example:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if (!is_file($file)) {</span><br><span class="line">   sleep(1); // delay check.</span><br><span class="line">}</span><br><span class="line">if (!is_file($file)) {</span><br><span class="line">    throw_503();</span><br><span class="line">    die();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<hr>

<p>Every little helps! I hope this helps!</p>
<p><strong>Steem On!~</strong></p>
<h2 id="Reposted-to-Blog"><a href="#Reposted-to-Blog" class="headerlink" title="*Reposted to Blog"></a>*Reposted to <a href="https://helloacm.com/design-how-to-solve-503-error-of-api-when-resources-are-not-available/" target="_blank" rel="noopener">Blog</a></h2><p>If you like my work, please consider voting for me, thanks!<br><a href="https://steemit.com/~witnesses" target="_blank" rel="noopener">https://steemit.com/~witnesses</a> type in <strong>justyy</strong> and click <strong><em>VOTE</em></strong><br><img src="https://steemyy.com/images/vote-for-justyy.jpg" alt=""></p>
<p><br><br><strong>Alternatively, you could <a href="https://steemyy.com/witness-voting/?witness=justyy&amp;action=proxy" target="_blank" rel="noopener">proxy to me</a>  if you are too lazy to vote!</strong></p>
<p>Also: you can vote me at the tool I made:  <a href="https://steemyy.com/witness-voting/?witness=justyy" target="_blank" rel="noopener">https://steemyy.com/witness-voting/?witness=justyy</a></p>
<h3 id="Visit-me-at-https-steemyy-com"><a href="#Visit-me-at-https-steemyy-com" class="headerlink" title="Visit me at:  https://steemyy.com"></a>Visit me at:  <a href="https://steemyy.com" target="_blank" rel="noopener">https://steemyy.com</a></h3><hr>
<p>This page is synchronized from the post: <a href="https://steemit.com/@justyy/design-how-to-solve-503-error-of-api-when-resources-are-not-available" target="_blank" rel="noopener">&#x2018;Design: How to Solve 503 Error of API when Resources are not available?&#x2019;</a></p>
<script>document.querySelectorAll(".not-gallery-item").forEach(e=>{if(!e.dataset.src)return;const t=document.createElement("img");t.style="display:none !important;",t.src=e.dataset.src,t.addEventListener("error",()=>{t.remove(),e.style.color="inherit",e.style.backgroundImage="none",e.style.background="none"}),t.addEventListener("load",()=>{t.remove()}),document.body.appendChild(t)});</script>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-image">
        <a href="/@justyy/a-bug-in-the-steemjs-regarding-the-incorrect-reputation/" class="image is-7by1">
            <img class="thumbnail" src="https://cdn.steemitimages.com/DQmQQuv3X3rB1QE6aD7GgnZgQM1LkSQrXMFucLkRpVmVCwy/image.png" alt="A Bug in the SteemJs Regarding the Incorrect Reputation">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-06-12T17:19:21.000Z">2020-06-12</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/@justyy/categories/programming/">programming</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 382 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/@justyy/a-bug-in-the-steemjs-regarding-the-incorrect-reputation/">A Bug in the SteemJs Regarding the Incorrect Reputation</a>
            
        </h1>
        <div class="content">
            <p>Current SteemJs Library has a bug in computing the reputation. I have <a href="https://github.com/steemit/steem-js/issues/344" target="_blank" rel="noopener">raised this</a> two years ago and <a href="https://github.com/steemit/steem-js/pull/345/" target="_blank" rel="noopener">proposed a fix</a></p>
<p>Specifically:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">console.log(steem.formatter.reputation(10004392664120));</span><br><span class="line">console.log(steem.formatter.reputation(10004392664120+100000000000));</span><br></pre></td></tr></tbody></table></figure>
<p>As you will see this output:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">70</span><br><span class="line">61</span><br></pre></td></tr></tbody></table></figure>
<p>Which is incorrect. The problem is at the code <a href="https://github.com/steemit/steem-js/blob/master/src/formatter.js#L166" target="_blank" rel="noopener">L166</a></p>
<p>Here, the developer probably didn&#x2019;t know the <code>Math.log10</code> function can be used to compute the Log10, instead, he/she uses a math trick <code>Math.log(x)/Math.log(10)</code> to compute the Math.log10 based on natural logarithm (base e ).</p>
<p>This will introduce rounding errors, and sometimes intermediate results will be amplified leading to much bigger errors.</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">console.log(Math.log10(1000))</span><br><span class="line">console.log(Math.log(1000)/Math.log(10))</span><br></pre></td></tr></tbody></table></figure>
<p>This will output</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2.9999999999999996</span><br></pre></td></tr></tbody></table></figure>
<p>In Line <a href="https://github.com/steemit/steem-js/blob/master/src/formatter.js#L168" target="_blank" rel="noopener">168</a>, it uses <code>parseInt</code>, therefore, the difference will be becoming ONE.</p>
<p>There are a few fixes:</p>
<ol>
<li>change <code>parseInt</code> to <code>Math.round</code></li>
<li>change entirely to use <code>Math.log10</code></li>
<li>or completely rewriting this function, as my PR (approved by @ety001 thanks!, but not merged yet due to this is a legacy PR which was created more than 2 years ago and the main branch has differed a lot).<br><a href="https://github.com/steemit/steem-js/pull/345/files" target="_blank" rel="noopener">https://github.com/steemit/steem-js/pull/345/files</a></li>
</ol>
<p><img src="https://cdn.steemitimages.com/DQmQQuv3X3rB1QE6aD7GgnZgQM1LkSQrXMFucLkRpVmVCwy/image.png" alt="image.png"></p>
<p>If you are happening to rely on this function, you probably need to do it yourself until this fix is merged.</p>
<hr>

<p>Every little helps! I hope this helps!</p>
<h2 id="Steem-On"><a href="#Steem-On" class="headerlink" title="Steem On!~"></a><strong>Steem On!~</strong></h2><p>If you like my work, please consider voting for me, thanks!<br><a href="https://steemit.com/~witnesses" target="_blank" rel="noopener">https://steemit.com/~witnesses</a> type in <strong>justyy</strong> and click <strong><em>VOTE</em></strong><br><img src="https://steemyy.com/images/vote-for-justyy.jpg" alt=""></p>
<p><br><br><strong>Alternatively, you could <a href="https://steemyy.com/witness-voting/?witness=justyy&amp;action=proxy" target="_blank" rel="noopener">proxy to me</a>  if you are too lazy to vote!</strong></p>
<p>Also: you can vote me at the tool I made:  <a href="https://steemyy.com/witness-voting/?witness=justyy" target="_blank" rel="noopener">https://steemyy.com/witness-voting/?witness=justyy</a></p>
<h3 id="Visit-me-at-https-steemyy-com"><a href="#Visit-me-at-https-steemyy-com" class="headerlink" title="Visit me at:  https://steemyy.com"></a>Visit me at:  <a href="https://steemyy.com" target="_blank" rel="noopener">https://steemyy.com</a></h3><hr>
<p>This page is synchronized from the post: <a href="https://steemit.com/@justyy/a-bug-in-the-steemjs-regarding-the-incorrect-reputation" target="_blank" rel="noopener">&#x2018;A Bug in the SteemJs Regarding the Incorrect Reputation&#x2019;</a></p>
<script>document.querySelectorAll(".not-gallery-item").forEach(e=>{if(!e.dataset.src)return;const t=document.createElement("img");t.style="display:none !important;",t.src=e.dataset.src,t.addEventListener("error",()=>{t.remove(),e.style.color="inherit",e.style.backgroundImage="none",e.style.background="none"}),t.addEventListener("load",()=>{t.remove()}),document.body.appendChild(t)});</script>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-image">
        <a href="/@justyy/steemjs-programming-what-happens-on-the-steem-blockchain-in-the-last-24-hours/" class="image is-7by1">
            <img class="thumbnail" src="https://steemyy.com/images/vote-for-justyy.jpg" alt="SteemJs Programming: What Happens on the Steem Blockchain in the Last 24 Hours?">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-06-11T19:10:21.000Z">2020-06-11</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/@justyy/categories/whalepower/">whalepower</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    3 minutes read (About 475 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/@justyy/steemjs-programming-what-happens-on-the-steem-blockchain-in-the-last-24-hours/">SteemJs Programming: What Happens on the Steem Blockchain in the Last 24 Hours?</a>
            
        </h1>
        <div class="content">
            <p>Many questions are interesting but the answers are not obvious or easy to get. For example:  Who comments most in the last 24 hours?</p>
<p>I am going to show you a pattern to find out the answers to such questions using <a href="https://steemyy.com/steemjs/" target="_blank" rel="noopener">SteemJs</a>. </p>
<h2 id="Get-Current-Lastest-Block"><a href="#Get-Current-Lastest-Block" class="headerlink" title="Get Current Lastest Block"></a>Get Current Lastest Block</h2><p>We need to get the latest block number on the steem blockchain, and we can work out roughly the last 24 hours block range by subtracting 20<em>60</em>24 (3 seconds a block).</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function getBlockchainData() {</span><br><span class="line">    return new Promise((resolve, reject) =&gt; {</span><br><span class="line">      steem.api.getDynamicGlobalProperties(function(err, result) {</span><br><span class="line">          if (!err) {</span><br><span class="line">              resolve(result);</span><br><span class="line">          } else {</span><br><span class="line">              reject(err);</span><br><span class="line">          }</span><br><span class="line">      });</span><br><span class="line">    });</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The current block number is:</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const blockchain = await getBlockchainData();</span><br><span class="line">const maxBlock = blockchain.head_block_number;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="Getting-the-Block-Content"><a href="#Getting-the-Block-Content" class="headerlink" title="Getting the Block Content"></a>Getting the Block Content</h2><p>Each block contains transactions, here you would need to parse the list of transactions and look for the particular ones that you are interested. For example, if we want to compute the total producer rewards by witnesses, we can look for &#x201C;producer_reward&#x201D;.</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">function getBlock(block) {</span><br><span class="line">    return new Promise((resolve, reject) =&gt; {</span><br><span class="line">        steem.api.getOpsInBlock(block, false, function(err, result) {</span><br><span class="line">          if (!err) {</span><br><span class="line">              const txCount = result.filter(x=&gt;x.virtual_op===0).length;</span><br><span class="line">              const producer = result.filter(x=&gt;x.op[0] === &quot;producer_reward&quot;);</span><br><span class="line">              const witness = producer[0].op[1].producer;</span><br><span class="line">              const reward = producer[0].op[1].vesting_shares;</span><br><span class="line">              resolve({</span><br><span class="line">                count: txCount,</span><br><span class="line">                witness: witness,</span><br><span class="line">                reward: reward.replace(&quot; VESTS&quot;, &quot;&quot;),</span><br><span class="line">                time: producer[0].timestamp.replace(&quot;T&quot;, &quot; &quot;)</span><br><span class="line">              });</span><br><span class="line">          } else {</span><br><span class="line">              reject(err);</span><br><span class="line">          }        </span><br><span class="line">        });</span><br><span class="line">    });</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="Writing-to-Database-or-a-File"><a href="#Writing-to-Database-or-a-File" class="headerlink" title="Writing to Database or a File"></a>Writing to Database or a File</h2><p>We need to write the data into a database, or for simplicity, we can write to a CSV file for later process.</p>
<figure class="highlight plain hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(async function() {</span><br><span class="line">    const blockchain = await getBlockchainData();</span><br><span class="line">    const maxBlock = blockchain.head_block_number;</span><br><span class="line">    for (let block = maxBlock - 20*60*24; block &lt;= maxBlock; ++ block) {</span><br><span class="line">        try {</span><br><span class="line">            const data = await getBlock(block);</span><br><span class="line">            const s = &apos;&quot;&apos; + data.time + &apos;&quot;,&apos; + block + &apos;,&quot;&apos; + data.witness + &apos;&quot;,&apos; + data.count + &quot;,&quot; + data.reward + &quot;\n&quot;;</span><br><span class="line">            log(s);</span><br><span class="line">            fs.appendFileSync(&apos;data.csv&apos;, s);</span><br><span class="line">        } catch (e) {</span><br><span class="line">            log(e);</span><br><span class="line">        }</span><br><span class="line">    }  </span><br><span class="line">})();</span><br></pre></td></tr></tbody></table></figure>
<p>Of course, if you want to further develop into a tool, you would need a database, and a background daemon that automatically syncs with the <a href="https://helloacm.com/illustrating-the-blockchain-via-steemjs-blocks-are-chained/" target="_blank" rel="noopener">blockchain</a>.</p>
<hr>

<p>Every little helps! I hope this helps!</p>
<p><strong>Steem On!~</strong></p>
<h2 id="Reposted-to-Blog"><a href="#Reposted-to-Blog" class="headerlink" title="Reposted to Blog"></a><em>Reposted to <a href="https://helloacm.com/steemjs-programming-what-happens-on-the-steem-blockchain-in-the-last-24-hours/" target="_blank" rel="noopener">Blog</a></em></h2><p>If you like my work, please consider voting for me, thanks!<br><a href="https://steemit.com/~witnesses" target="_blank" rel="noopener">https://steemit.com/~witnesses</a> type in <strong>justyy</strong> and click <strong><em>VOTE</em></strong><br><img src="https://steemyy.com/images/vote-for-justyy.jpg" alt=""></p>
<p><br><br><strong>Alternatively, you could <a href="https://steemyy.com/witness-voting/?witness=justyy&amp;action=proxy" target="_blank" rel="noopener">proxy to me</a>  if you are too lazy to vote!</strong></p>
<p>Also: you can vote me at the tool I made:  <a href="https://steemyy.com/witness-voting/?witness=justyy" target="_blank" rel="noopener">https://steemyy.com/witness-voting/?witness=justyy</a></p>
<h3 id="Visit-me-at-https-steemyy-com"><a href="#Visit-me-at-https-steemyy-com" class="headerlink" title="Visit me at:  https://steemyy.com"></a>Visit me at:  <a href="https://steemyy.com" target="_blank" rel="noopener">https://steemyy.com</a></h3><hr>
<p>This page is synchronized from the post: <a href="https://steemit.com/@justyy/steemjs-programming-what-happens-on-the-steem-blockchain-in-the-last-24-hours" target="_blank" rel="noopener">&#x2018;SteemJs Programming: What Happens on the Steem Blockchain in the Last 24 Hours?&#x2019;</a></p>
<script>document.querySelectorAll(".not-gallery-item").forEach(e=>{if(!e.dataset.src)return;const t=document.createElement("img");t.style="display:none !important;",t.src=e.dataset.src,t.addEventListener("error",()=>{t.remove(),e.style.color="inherit",e.style.backgroundImage="none",e.style.background="none"}),t.addEventListener("load",()=>{t.remove()}),document.body.appendChild(t)});</script>
        </div>
        
        
        
    </div>
</div>








    <div class="card">
    
    <div class="card-image">
        <a href="/@justyy/new-tool-steem-witness-update-tool/" class="image is-7by1">
            <img class="thumbnail" src="https://cdn.steemitimages.com/DQmNMcwBSWyFbnijYvMoBdePRCgyosskve1KzJL2zB9B2ba/image.png" alt="New Tool: Steem Witness Update Tool">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
                <time class="level-item has-text-grey" datetime="2020-06-10T18:12:54.000Z">2020-06-10</time>
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/@justyy/categories/witness-category/">witness-category</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    2 minutes read (About 234 words)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/@justyy/new-tool-steem-witness-update-tool/">New Tool: Steem Witness Update Tool</a>
            
        </h1>
        <div class="content">
            <p>Added another tool to broadcast witness update:</p>
<p>Tool URL: <a href="https://steemyy.com/witness-update/" target="_blank" rel="noopener">https://steemyy.com/witness-update/</a><br>Chinese: <a href="https://steemyy.com/witness-update-tool/" target="_blank" rel="noopener">https://steemyy.com/witness-update-tool/</a></p>
<h1 id="What-this-tool-can-do-for-you"><a href="#What-this-tool-can-do-for-you" class="headerlink" title="What this tool can do for you?"></a>What this tool can do for you?</h1><p>Usually, I send update using the <code>conductor</code> directly on my witness server. But sometimes when you are not able to SSH, this tool would be handy.</p>
<p>Click &#x201C;Get Witness Information&#x201D; which will retrieve the current Witness Data and populate in the fields.<br><img src="https://cdn.steemitimages.com/DQmNMcwBSWyFbnijYvMoBdePRCgyosskve1KzJL2zB9B2ba/image.png" alt="image.png"></p>
<p>A friendly advice: Set Signing Key to  <code>STM1111111111111111111111111111111114T1Anm</code> to take your witness offline if you are not able to make it! (to avoid missing blocks and be voted out)</p>
<hr>

<p>Every little helps! I hope this helps!</p>
<h2 id="Steem-On"><a href="#Steem-On" class="headerlink" title="Steem On!~"></a><strong>Steem On!~</strong></h2><p>If you like my work, please consider voting for me, thanks!<br><a href="https://steemit.com/~witnesses" target="_blank" rel="noopener">https://steemit.com/~witnesses</a> type in <strong>justyy</strong> and click <strong><em>VOTE</em></strong><br><img src="https://steemyy.com/images/vote-for-justyy.jpg" alt=""></p>
<p><br><br><strong>Alternatively, you could <a href="https://steemyy.com/witness-voting/?witness=justyy&amp;action=proxy" target="_blank" rel="noopener">proxy to me</a>  if you are too lazy to vote!</strong></p>
<p>Also: you can vote me at the tool I made:  <a href="https://steemyy.com/witness-voting/?witness=justyy" target="_blank" rel="noopener">https://steemyy.com/witness-voting/?witness=justyy</a></p>
<h3 id="Visit-me-at-https-steemyy-com"><a href="#Visit-me-at-https-steemyy-com" class="headerlink" title="Visit me at:  https://steemyy.com"></a>Visit me at:  <a href="https://steemyy.com" target="_blank" rel="noopener">https://steemyy.com</a></h3><hr>
<p>This page is synchronized from the post: <a href="https://steemit.com/@justyy/new-tool-steem-witness-update-tool" target="_blank" rel="noopener">&#x2018;New Tool: Steem Witness Update Tool&#x2019;</a></p>
<script>document.querySelectorAll(".not-gallery-item").forEach(e=>{if(!e.dataset.src)return;const t=document.createElement("img");t.style="display:none !important;",t.src=e.dataset.src,t.addEventListener("error",()=>{t.remove(),e.style.color="inherit",e.style.backgroundImage="none",e.style.background="none"}),t.addEventListener("load",()=>{t.remove()}),document.body.appendChild(t)});</script>
        </div>
        
        
        
    </div>
</div>









    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/@justyy/page/0/">Previous</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/@justyy/page/2/">Next</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/@justyy/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/@justyy/page/2/">2</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/@justyy/page/288/">288</a></li>
            
        </ul>
    </nav>
</div>
</div>
            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/@justyy/">
                
                    <img src="https://avatars0.githubusercontent.com/u/50857551?s=200&v=4" alt="justyy" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 justyy&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("en_US.UTF-8");</script>


    
    
    
    <script src="/@justyy/js/animation.js"></script>
    

    
    
    
    <script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
    
    

    
    

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>document.addEventListener("DOMContentLoaded",function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"flex"})});</script>


    
    
<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>document.addEventListener("DOMContentLoaded",function(){MathJax.Hub.Config({"HTML-CSS":{matchFontHeight:!1},SVG:{matchFontHeight:!1},CommonHTML:{matchFontHeight:!1},tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}})});</script>

    
    

<a id="back-to-top" title="Back to Top" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>



    
    

    
    
    
    

    
    
    
    
    
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>
    
    

    
    
    





    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="Type something...">
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},CONTENT_URL:"/@justyy/content.json"};</script>



    
<script src="/@justyy/js/bundle.js" defer></script></body>
</html>

