
---
title: '每天进步一点点：学习使用LVM'
permlink: lvmb9f338d570
catalog: true
toc_nav_num: true
toc: true
position: 9999
date: 2019-12-14 13:44:36
categories:
- cn
tags:
- cn
- lvm
- study
- linux
- busy
thumbnail: 'https://steemitimages.com/DQmRkLq6rRew3mHfx4vYGWyqpC8wSebLPeC2iZCXAdpuGkR/image.png'
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---



为了方便动态扩容，我这次准备使用LVM来管理空间，不直接在硬盘上分区、创建文件系统以及挂载了。

![](https://steemitimages.com/DQmRkLq6rRew3mHfx4vYGWyqpC8wSebLPeC2iZCXAdpuGkR/image.png)
(图源 ：[pixabay](https://pixabay.com/))

# 确定新硬盘

操作之前，先看用sudo fdisk -l 看一下我的新硬盘，可以看到新硬盘为/dev/sdc。

>`sudo fdisk -l`

![](https://cdn.steemitimages.com/DQmRLDciTWfnYFQnWTQFEJ4FXYFqi1hHkoX97q13EBmCpth/image.png)

# 创建PV

首先要创建PV，使用的命令为`pvcreate`(Initialize physical volume(s) for use by LVM)，我直接在新硬盘上创建。

>`sudo pvcreate /dev/sdc`

![](https://cdn.steemitimages.com/DQmeW2MSUqwCvM7dBNgn9B34SuHk2wRNL4fKxm1U9TApacg/image.png)

# 创建VG

创建VG使用的命令为`vgcreate`，这里我为VG起的名字为vg_storage。
>`sudo vgcreate vg_storage /dev/sdc`

![](https://cdn.steemitimages.com/DQmbm4YdnpN9JDGFEdD9sdzi3kNLqYEpUyE426vfXs8sc6u/image.png)

创建完成后可以用`vgdisplay`查看一下：
>`sudo vgdisplay`

![](https://cdn.steemitimages.com/DQmevfGPEwaXAnTYjopQHGt7KBtwFyFmBcYsiZcCTCNS6rd/image.png)

# 创建LV

接下来是创建LV，使用命令为`lvcreate`(Create a logical volume)。

 创建线性的LV命令为：
`lvcreate -L|--size Size[m|UNIT] VG`

我使用了如下命令：
>`sudo lvcreate -n lv_main -L 3200M vg_storage`

![](https://cdn.steemitimages.com/DQmR2ujRKWeSmpbBBCgczuYEvNiY58UwJePP6qSnoRV9ohe/image.png)

创建完成后，查看一下：
>`sudo lvdisplay`

![](https://cdn.steemitimages.com/DQme5cxokUbvX7PPshU1U5cnS9s3HZdPJPS9coafH9mgHSa/image.png)

擦，我原本想创建的是3.2T，结果弄成了3.12G，囧。

# 扩容

既然创建错了，那就直接扩容一下吧，弄成3T吧：
>`sudo lvextend -L 3145728M /dev/vg_storage/lv_main`

![](https://cdn.steemitimages.com/DQmUogZtfsZxGfx738wTEphYwGiT3DWecuEXJjXTB9kcidz/image.png)

>` sudo lvdisplay`

这次看起来没问题的
![](https://cdn.steemitimages.com/DQmXkPbURGnWjq9LgM9iCyKUQM4dMsrUyxPLB1xvs2n2ape/image.png)

再来看看VG
>`sudo vgdisplay`

可以看到总的PE以及已分配的PE
![](https://cdn.steemitimages.com/DQmeLDRJdAwEvnwqNRYy7y3VvT6BZJtMNxj2frehE1M817p/image.png)

# 格式化& 挂载

接下来将lv格式化
>`sudo mkfs.ext4 /dev/vg_storage/lv_main`

![](https://cdn.steemitimages.com/DQmUatAQscVe1Rdu6JLNpEXTinfUcodTF9weyDr77C9LPgd/image.png)

创建目录并测试挂载：
>`sudo mkdir /lv_main`
>`sudo mount  /dev/vg_storage/lv_main /lv_main`

编辑fstab
>`sudo vi /etc/fstab`

添加如下内容：
>`/dev/vg_storage/lv_main /lv_main ext4 defaults 0 0`

重启，一切正常，搞定收工。

----
<center><strong>Vote For Me As Witness</strong>
https://steemit.com/~witnesses type in **`oflyhigh`** and click ***`VOTE`***
[![](https://cdn.steemitimages.com/DQmX5NysqT44FBa3bhuWqQ69nAbseu8Nt5YQPn2pYejPVxA/image.png)](https://steemit.com/~witnesses)
[Vote @oflyhigh via Steemconnect](https://steemconnect.com/sign/account-witness-vote?witness=oflyhigh&approve=1)
<strong>Thank you!</strong></center>


- - -

This page is synchronized from the post: ['每天进步一点点：学习使用LVM'](https://steemit.com/@oflyhigh/lvmb9f338d570)
