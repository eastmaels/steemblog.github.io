
---
title: '解决了一个微信公众号查询见证人信息的BUG'
permlink: bug
catalog: true
toc_nav_num: true
toc: true
date: 2018-07-29 02:35:12
categories:
- witness
tags:
- witness
- wechat
- steemit
- cn
- bug
thumbnail: https://cdn.steemitimages.com/DQmNqD746ke9wbLM1mXqgzdXTSwPEed6ovbUJpJ1VXKxdsA/image.png
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---


早晨还没睡醒的时候，就看到 @justyy 在微信群里艾特我，并发过来一个截图，说是微信公众号查STEEMIT见证人信息有BUG。

![](https://cdn.steemitimages.com/DQmNqD746ke9wbLM1mXqgzdXTSwPEed6ovbUJpJ1VXKxdsA/image.png)
(图源 ：[pixabay](https://pixabay.com/))

我写的程序怎么可能有BUG呢？况且查了这么多见证人也没发现啥问题啊，一定是他使用的姿势不对，哦，我想起来了，一定是他查询的这个见证人排名超出了200名以外，因为我只处理200名以内的见证人。嗯，就是这样了，继续睡。

>![](https://cdn.steemitimages.com/DQmaCRWzmHepSbaFzF6Tn91BTKYZee7myhQB83HwGUWrj9j/image.png)

等我睡醒了，再仔细一看这个截图，这还不是BUG是啥啊？得票这么低的见证人，居然被我算成了TOP20，并且收益也这么高，这显然不对嘛。

于是看了一下之前的程序，我擦，这写的都是什么乱七八糟的，根本看不懂啊，费了半天劲，总算理清了程序的流程，然后也找到了问题所在。

根本原因就是我只处理200名以内的见证人，对200名以外的见证人没有妥善处理。其实我也处理了，但是处理的程序有些漏洞，PHP对一个不存在的变量，读出来的数据是0。正确的做法是，在这之前，判断一下变量是否存在：`isset($info["rank"])`。

>![](https://cdn.steemitimages.com/DQmVUY7oVyDfV6yW7qEDLeBnBWjhLouX25ZydWfcFoCX3s5/image.png)

这样修改之后，类型已经变成正常的**`TimeShare`**，不再是**`TOP20`**了，每块的奖励也正常了。但是每天出块以及每天收益啥的数据都为零，这很正常，因为我没计算200名以外的见证人嘛，我之前觉得200名以外都不会去查这个信息的。不过既然有人查了，那么再加大一些吧，加大到400吧（一共有没有400呢，哈哈）

>![](https://cdn.steemitimages.com/DQmWPHUKWEoLWBWLCDkbC4tkp63kdyZBQJ3TmxMQSAqEsYA/image.png)

这下都正确了，哈哈，只是这哥们每天0.1个STEEM能够上服务器成本否？心疼呀。另外感谢 @justyy 报告了这个BUG，CN区还没有投他见证人的朋友，去投他一票吧。😀

对了，顺便安利公众号，扫码即可添加：
![](https://cdn.steemitimages.com/DQmXL2uabBd3NRw5Lyt9HMxFBpJe3hXGbsTWDEoVW7t8dEW/image.png)

- - -

This page is synchronized from the post: [解决了一个微信公众号查询见证人信息的BUG](https://steemit.com/@oflyhigh/bug)
