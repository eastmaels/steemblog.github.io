
---
title: 'OMG,  收益分享，可怕的功能，搞迷糊了'
permlink: omg
catalog: true
toc_nav_num: true
toc: true
date: 2017-07-06 13:42:48
categories:
- cn
tags:
- cn
- cn-programming
thumbnail: https://steemitimages.com/DQmQER5y1voeg6UqvDA8xAkPCLYU4csXECX8Ux19Hsnk77a/image.png
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---


![](https://steemitimages.com/DQmQER5y1voeg6UqvDA8xAkPCLYU4csXECX8Ux19Hsnk77a/image.png)

前几天，我发了一个测试收益分享功能的帖子：

* [测试收益分享功能/Test Comment Reward Beneficiaries](https://steemit.com/cn/@oflyhigh/test-comment-reward-beneficiaries)

# 收益分享帖子

其中受益者名单和比例如下：
受益人 / Beneficiaries

```
beneficiaries = [
         {'account': 'ace108', 'weight': 500},
         {'account': 'deanliu', 'weight': 500},
         {'account': 'laodr', 'weight': 500},
         {'account': 'lemooljiang', 'weight': 500},
         {'account': 'rivalhw', 'weight': 500}
     ]
```

帖子发表成功，并且选项设置也很正常
![](https://steemitimages.com/0x0/https://steemitimages.com/DQmfLUwF8g1fGHWJFd4LHEcNptJwmiX5ncdA8s1evqGGPNv/image.png)

其中 500，表示占所有收益权重的5%
如果是10000，则代表100%

# 奖励结算

昨天，看到帖子已经结算
![](https://steemitimages.com/DQmWdsrXqhcktv6dKkC8AMr3WCvTWeRiJmoGyE2hABa3pDR/image.png)

author-rewards条目下也可以看到：
`yesterday	43.177 SBD, and 26.290 STEEM POWER for oflyhigh/test-comment-reward-beneficiaries`

因为给作者的收益要去刨除点赞者的收益(Curator)，所以发给我的应该是`86.35 SBD`
因为我选择的是50%/50%，所以分成了SBD和STEEM POWER两个部分。
`43.177 SBD, and 26.290 STEEM POWER`
由此可见，系统当时核算的STEEM POWER价格为 ： 
`43.177 / 26.290 =  1.64234 SBD/STEEM Power`

好，截至目前，没啥问题。

# 收益分享

然后，看了一下钱包(Wallet)中历史信息(HISTORY)中的条目
分享的部分是已 VESTS的形式发放的，其实就是STEEM POWER
然后好奇计算一下，到底发放了多少个STEEM POWER给茶东们呢？

![](https://steemitimages.com/DQmSNnQrNA8k52sjgZJnzwf1rR1xmBJAHTTxxSumsHC2CCB/image.png)


VESTS与STEEM POWER的换算关系如下：
`STEEM POWER = total_vesting_fund_steem/total_vesting_shares * VESTS`

然后用程序取得两个值后换算了一下`7247.465650 VESTS` 等于多少STEEM POWER
结果是： `3.504 STEEM POWER`
嗯，看起来也不是很多嘛

等等，似乎哪里看起来不对呢？
我的收益的50%是STEEM POWER :  `26.290 STEEM POWER`
那么5%是多少？明明应该是: `2.629 STEEM POWER`
多发了： `3.504  - 2.629 = 0.875 个 STEEM POWER`

这是咋回事？

就算是未刨除点赞者收益之前， 也不过应该是： 
`$107.00 / 1.64234 * 5% = 3.2575  STEEM POWER`
也到不了 3.5啊？


# 疑问

对比我发帖子时以及程序设置中的期望值与结果，难免产生以下疑问：

* 收益分享，分享的是去除点赞者收益后作者实际收益的百分比吗？
* 收益分享的SP核算价格，是current_median_history_price 还是市场价格？

最大的疑问是，***作者(文章发布者)设置收益分享后，有没有可能倒搭钱？***如果那样，可就欢乐了。😀

谁能帮我解答一下呢？或者要去研究一下steem的代码？想想就想吐血了。

----
感谢阅读 / Thank you for reading.
欢迎upvote、resteem以及 following me @oflyhigh 😎

- - -

This page is synchronized from the post: [OMG,  收益分享，可怕的功能，搞迷糊了](https://steemit.com/@oflyhigh/omg)
