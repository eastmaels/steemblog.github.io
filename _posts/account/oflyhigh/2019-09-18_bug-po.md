
---
title: '修复微信公众号的BUG之：po指令（查看近期文章收益）'
permlink: bug-po
catalog: true
toc_nav_num: true
toc: true
position: 9999
date: 2019-09-18 01:53:30
categories:
- cn
tags:
- cn
- wechat
- bug
- steemit
- post
thumbnail: 'https://cdn.steemitimages.com/DQma8TWyWZ1aXdTALQuizh2i4T3WQpweytcoAgzUa4Nx4Hc/image.png'
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---


HF21/HF22带来了许多改变，比如SPS(STEEM提案系统)以及EIP(经济改善提案)，其中SPS动了通胀10%的奶酪，EIP修改了收益曲线以及点赞收益比例等。这些改动却影响了微信公众号的正常工作。

![](https://cdn.steemitimages.com/DQma8TWyWZ1aXdTALQuizh2i4T3WQpweytcoAgzUa4Nx4Hc/image.png)
(图源 ：[pexels.com](https://www.pexels.com/))

以`po`指令为例，这个指令是用于查看用户近期文章（最近10篇）收益，大家都知道STEEMIT在国内被墙，需要科学上网才能访问，那么不考虑发帖的话，有个很方便的方式看看自己的近期文章收益也挺好的。

可是当我用`po`指令查看自己的文章收益时，却发现似乎哪里不对?
>![](https://cdn.steemitimages.com/DQmf39nAFhbpDGU93kNgLuVHgXLuFgsrDutGiq5RZpusQde/image.png)


对照一下STEEMIT上显示的收益，就知道问题所在啦：
>![](https://cdn.steemitimages.com/DQmQxydfANDU9gXHLsiK3QHPSoBLv7WQCkJfqmv3ya7aypH/image.png)

原来是公众号显示的金额不正确，看了一下我原来的程序实现，是使用文章的`net_rshares`以及奖励池资金情况，计算出文章价值。

之所以可以这样做，是因为HF18(似乎好像是)到HF20，都使用的是线性收益曲线(`linear curve`)，估算起来非常方便。

而HF21/HF22使用的是`convergent_linear  curve`，我弄了半天也没搞明白，哎，还是直接拿帖子给出的奖励数据吧。

未结算的帖子奖励可以通过`pending_payout_value`获取，已结算的帖子通`total_payout_value`和`curator_payout_value`获取。

再来测试一下，嗯，这个数据是正确的，我们又可以愉快地查询啦：
>![](https://cdn.steemitimages.com/DQmbykuQuikwd5xohqoRQH72vkUAqwqcZEccxr3YZKPSebm/image.png)

# 微信公众号

微信公众号继续欢迎大家关注，有很多方便的小功能，还在不断完善中。
![](https://cdn.steemitimages.com/DQmZGHbCGz263CJHT5wLff6zqQJF5nEPC5RkZWJocmqLZE3/image.png)

----
<center><strong>Vote For Me As Witness</strong>
https://steemit.com/~witnesses type in **`oflyhigh`** and click ***`VOTE`***
[![](https://cdn.steemitimages.com/DQmX5NysqT44FBa3bhuWqQ69nAbseu8Nt5YQPn2pYejPVxA/image.png)](https://steemit.com/~witnesses)
[Vote @oflyhigh via Steemconnect](https://steemconnect.com/sign/account-witness-vote?witness=oflyhigh&approve=1)
<strong>Thank you!</strong></center>

- - -

This page is synchronized from the post: ['修复微信公众号的BUG之：po指令（查看近期文章收益）'](https://steemit.com/@oflyhigh/bug-po)
