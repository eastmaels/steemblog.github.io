
---
title: '每天进步一点点：UFW简单使用（二）'
permlink: 4blwra-ufw
catalog: true
toc_nav_num: true
toc: true
position: 9999
date: 2019-09-23 01:13:00
categories:
- cn
tags:
- cn
- ufw
- ubuntu
- linux
- study
thumbnail: 'https://steemitimages.com/DQmRkLq6rRew3mHfx4vYGWyqpC8wSebLPeC2iZCXAdpuGkR/image.png'
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---


在[之前的文章中](https://steemit.com/cn/@oflyhigh/ufw)，我简单介绍了UFW的安装以及启用、禁用、查看帮助等等，今天来进一步学习UFW的使用。

![](https://steemitimages.com/DQmRkLq6rRew3mHfx4vYGWyqpC8wSebLPeC2iZCXAdpuGkR/image.png)
(图源 ：[pixabay](https://pixabay.com/))


# 查看状态

了解UFW的当前状态对我们更好地使用UFW而言非常重要，查看状态的指令如下：

>`ufw status [verbose|numbered]`

使用`verbose`或者`numbered`会显示更多的额外信息，`numbered`会给规则添加上序号。

在我们未启用UFW之前，查看状态的指令会返回如下信息：
>Status: inactive

# 允许/禁止

按照之前文章说的描述，禁止所有允许特定，相对而言是比较安全的策略。那么如何允许特定的端口或者服务呢？

假设我们要允许网络上主机访问80端口，提供HTTP服务，那么相应的指令如下：
>`sudo ufw allow 80/tcp`

如果我们要允许SSH服务，那么相应的指令为：
>`sudo ufw allow ssh`

使用`sudo ufw enable`激活配置后，我们来看一下当前ufw的状态：
`sudo ufw status`

>![](https://cdn.steemitimages.com/DQmSpRgQgdzWtaJZ9FdsU6zsWqS3TVtLBC6wzibS6qq8GGC/image.png)

从上述状态中我们可以看到所谓的允许XXX服务，只不过是根据允许服务的默认端口，而不是根据实际配置来设置。

禁止的指令大同小异，比如说禁止访问25端口：
>`sudo ufw deny 25`

设置后状态如下：
>![](https://cdn.steemitimages.com/DQme2E9sqdmzStedaqEdN2b2uAGAtckWPzCuXFN2hB76EQh/image.png)

# 删除规则

在上述例子中，因为我们默认禁用了所有链接，所以再禁用25其实是多此一举，那么如何删掉无用的规则呢？

使用如下指令即可：
>`sudo ufw delete  deny 25`

注意到有什么特征了嘛？其实就是在ufw和规则之间，添加了个`delete`关键字。

因为SSH的端口我们已经改变了，其实当前这个也是无用的，顺手删除吧。
>`sudo ufw delete  allow ssh`

当前状态如下：
>![](https://cdn.steemitimages.com/DQmasAEntwsb4BP77Na3zikn2JwgpezA6E25vUrFYhoXQuS/image.png)

# 按编号删除规则

虽然上述删除指令用起来还算简单，但是要多敲好多字符，如果能把规则编号，然后按编号删除就好了。

这时候就要上场之前讲过的按编号查看状态/规则了。
>`sudo ufw status numbered`

>![](https://cdn.steemitimages.com/DQmS5HHkDDRNLEnNHJp77KFPYGXg46c9ejjxfhuKbot6zZW/image.png)

然后我们就可以愉快地按编号删除啦，比如其实我并没有开启IPV6版的HTTP服务，那么把他删掉吧。
>`sudo ufw delete  2`

再来看状态，正是我们想要的样子：
>![](https://cdn.steemitimages.com/DQmZfcWxXhDmQuTHRtAozVZVhyhYNz64CabhdZdArAkA4hb/image.png)


好了，这节就先讲到这里吧，敬请期待后续内容。下一节我们将讲如何允许/禁止IP，以及一些复杂规则。

# 相关链接

* [每天进步一点点：UFW简单使用（一）](https://steemit.com/cn/@oflyhigh/ufw)
* [UncomplicatedFirewall](https://wiki.ubuntu.com/UncomplicatedFirewall)
* [UFW Manual for Ubuntu 18.04](http://manpages.ubuntu.com/manpages/bionic/en/man8/ufw.8.html)
* [Ubuntu Community Documentation on UFW](https://help.ubuntu.com/community/UFW)

----
<center><strong>Vote For Me As Witness</strong>
https://steemit.com/~witnesses type in **`oflyhigh`** and click ***`VOTE`***
[![](https://cdn.steemitimages.com/DQmX5NysqT44FBa3bhuWqQ69nAbseu8Nt5YQPn2pYejPVxA/image.png)](https://steemit.com/~witnesses)
[Vote @oflyhigh via Steemconnect](https://steemconnect.com/sign/account-witness-vote?witness=oflyhigh&approve=1)
<strong>Thank you!</strong></center>

- - -

This page is synchronized from the post: ['每天进步一点点：UFW简单使用（二）'](https://steemit.com/@oflyhigh/4blwra-ufw)
