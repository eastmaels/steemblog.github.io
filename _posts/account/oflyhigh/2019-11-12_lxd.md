
---
title: '纸上得来终觉浅：lxd初体验'
permlink: lxd
catalog: true
toc_nav_num: true
toc: true
position: 9999
date: 2019-11-12 01:43:45
categories:
- cn
tags:
- cn
- lxdcontainer
- linux
- study
thumbnail: 'https://steemitimages.com/DQmRkLq6rRew3mHfx4vYGWyqpC8wSebLPeC2iZCXAdpuGkR/image.png'
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---


还记得我写过的[lxc初体验](https://steemit.com/cn/@oflyhigh/lxc)嘛？在那篇帖子中，我曾经说过lxd是lxc的进化版，这篇文章中我们来测试一下lxd。

![](https://steemitimages.com/DQmRkLq6rRew3mHfx4vYGWyqpC8wSebLPeC2iZCXAdpuGkR/image.png)
(图源 ：[pixabay](https://pixabay.com/))

# 安装

如果还没有安装lxd，那么我们需要如下步骤来安装lxd并且让当前用户可以直接使用lxd的相关命令。

安装lxd
>`sudo apt install lxd`

登出并重新登录当前用户，以刷新组成员信息，或者使用如下指令：
>`newgrp lxd`


在一台新的VPS上，我进行这样的操作后，也无法直接只用诸如`lxc list`等命令，出现下列错误：
>![](https://cdn.steemitimages.com/DQmNzSVQSsEphNo2wyhk83GHYp88mkGLeHvSSymwJEcWfFn/image.png)
>Error: Get http://unix.socket/1.0: dial unix /var/lib/lxd/unix.socket: connect: permission denied

只好手工把用户添加到组lxd中：
>`sudo usermod -a -G lxd $(whoami)`

可以使用`groups`命令来检查关联组别是否成功。

# lxd初始化

在正式开始之前，我们还需要执行`lxd init`来进行一些初始化设置（网络、存储等等）。

>`lxd init`

我们都选择默认设置即可（空间我设置的5G，因为我磁盘空间比较紧张)：
>![](https://cdn.steemitimages.com/DQmWSzoQRbxCMLJJMh1KSzLoSXoNX8rhHqVSRAzZhdgz9u3/image.png)

# 查询/创建/使用容器

#### 查询

在进行完上述设置后，我们可以使用如下命令查询我们机器上的lxd容器：
>`lxc list`

可以看到我们现在一个容器都没有呢：
>![](https://cdn.steemitimages.com/DQmez5XvULRaBkkoJ2F1ME4f3gXnhm9qq46RsKupDsswtQE/image.png)

注：***lxc并非之前文章中的lxc，本文中代表的是lxd的客户端。***

#### 创建

下面来创建我们的第一个lxd容器：
>`lxc launch ubuntu:18.04 first`

创建后，容器会自动启动：
>![](https://cdn.steemitimages.com/DQmV1bzxwF7SRYfHSeiWa1mjpCceNRsUkENsgxY1EKF37hx/image.png)


再来查询一下：
>`lxc list`

耶，有了一个(我有些后悔，初始化的时候应该关闭ipv6，看着闹心）：
>![](https://cdn.steemitimages.com/DQmbFFCYstEvGAUPc9RmRLyee3MxHPLKB1fXZdv7CbPfhi5/image.png)

# 使用

我们可以使用如下命令进入到对应的容器中：
>`lxc exec first -- /bin/bash`

或者执行命令，拉取文件，推送文件等：
>`lxc exec first -- apt-get update`
>`lxc file pull first/etc/hosts .`
>`lxc file push hosts first/tmp/`

至于关闭和开启可以用如下命令：
>`lxc stop first`
>`lxc start first`

不需要了，可以用以下命令删除：
>`lxc delete first`

开了一大堆自己玩，哈哈：
>![](https://cdn.steemitimages.com/DQmXunvPM4ttmmcZm2Br4y7mqSoPhnCxGPyQydEtn6mcG7U/image.png)

是不是很好玩的样子，感兴趣的朋友也试试吧。


# 相关链接

* [纸上得来终觉浅：lxc初体验](https://steemit.com/cn/@oflyhigh/lxc)
* [LXD Getting started - command line](https://linuxcontainers.org/lxd/getting-started-cli/)
* https://www.ubuntu.org.cn/cloud/lxd
* https://linuxcontainers.org/lxd/try-it/

----
<center><strong>Vote For Me As Witness</strong>
https://steemit.com/~witnesses type in **`oflyhigh`** and click ***`VOTE`***
[![](https://cdn.steemitimages.com/DQmX5NysqT44FBa3bhuWqQ69nAbseu8Nt5YQPn2pYejPVxA/image.png)](https://steemit.com/~witnesses)
[Vote @oflyhigh via Steemconnect](https://steemconnect.com/sign/account-witness-vote?witness=oflyhigh&approve=1)
<strong>Thank you!</strong></center>

- - -

This page is synchronized from the post: ['纸上得来终觉浅：lxd初体验'](https://steemit.com/@oflyhigh/lxd)
