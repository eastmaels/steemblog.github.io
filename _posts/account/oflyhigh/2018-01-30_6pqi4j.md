
---
title: '节点同步数据完成/ 内存、磁盘占用、运行应用、测试插件'
permlink: 6pqi4j
catalog: true
toc_nav_num: true
toc: true
date: 2018-01-30 02:52:33
categories:
- bitshares
tags:
- bitshares
- bts
- cn
- cn-programming
- study
thumbnail: https://steemitimages.com/DQmTJmseiuZF87AXSGxdTLwC2ZXUz2p34BEUSgpfQdQaQai/image.png
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---


之前尝试了[编译BitShares Core](https://steemit.com/bitshares/@oflyhigh/bitshares-core)，并且在昨晚10点以后开始已最精简的方式[同步节点数据](https://steemit.com/bitshares/@oflyhigh/5mqv5m)。

![](https://steemitimages.com/DQmTJmseiuZF87AXSGxdTLwC2ZXUz2p34BEUSgpfQdQaQai/image.png)
(图源 ：[pixabay](https://pixabay.com))

原本以为会同步很久，都计划按3、5天准备了，并且心里也在担忧8G内存到底够不够用呢？结果早晨上来一看，呀，竟然已经完成数据同步了，还真给了我一个大大的惊喜。
![](https://steemitimages.com/DQmNULiRBoxkZFm2P7vW8YT89tXFqDxAxkMmEjoEUaFfFR2/image.png)

# 内存、磁盘占用

用pmap查看了一下内存占用
![](https://steemitimages.com/DQmTWNTWumiYw1dLq61nKYoeoJuydxyHByNHWBs8C4Mop13/image.png)
什么，你没看错，***内存占用竟然只需要2G出头的样子***

换htop指令再试
![](https://steemitimages.com/DQmcoMyZzVH88Xin9MqjPyXhnNqrWeLknvB3Qy87WBJw1Sm/image.png)
看到没有，***整个vps实际再用的不过才1.1G***

再来看一下空间占用
![](https://steemitimages.com/DQmePUSqC3F1XbLaARSSmC8hjmakZrsP2MyZqPN34TouvZf/image.png)
只占了11G

# 运行应用

还记得我们之前弄的抵押率排行榜之类的东东吗？在改进之后，读取100条的记录耗时约3秒。

为了对比明显，我这次生成1500条记录试试看。

![](https://steemitimages.com/DQmTfZAwBPgXMLuaiCcy1RKKnVRQhEv3AgzcrsH9ubTWDfs/image.png)
***使用第三方节点，耗时约为16.5秒***

![](https://steemitimages.com/DQmQbtsVKR8cqt21stVzCBSRg4Kos4SPJ4SCJ3qYzmJuGQV/image.png)
***使用本地节点，耗时仅为2秒出头，效率大幅提升呀***

再来测试一下内部市场订单列表
![](https://steemitimages.com/DQmZPEaybrnZoNfZzMavBXtHNngVQJ6X4MvkDXVUyVkb9E9/image.png)
***使用第三方节点，耗时约为3秒***

![](https://steemitimages.com/DQmcXG9VSYJRYuFw2ZECYCsUViQ99N6QxzfebWydm3FUP5g/image.png)
***使用本地节点，耗时竟然不到0.02秒，震惊***

# 测试插件

我们在运行witness_node的时候，只运行了witness插件，相当于禁用了account_history以及market_history插件功能，那我们就来试试有没有什么影响。

我们来随便测试一个API: ***`get_market_history_buckets`***
它无需参数，我比较喜欢

使用第三方节点：
`curl --data '{"jsonrpc": "2.0", "method": "call", "params": ["history", "get_market_history_buckets", []], "id": 1}' https://ws.gdex.top`

返回如下
![](https://steemitimages.com/DQmXRGAsarXm3AgeuPUa8h3EokJJHwydvMxjs9XLbk16eo1/image.png)
可见是可以正常使用滴

使用本地节点
`curl -s --data '{"jsonrpc": "2.0", "method": "call", "params": ["history", "get_market_history_buckets", []], "id": 1}' http://127.0.0.1:8090/rpc`
![](https://steemitimages.com/DQmc7xFoBYpKZynh1LmfWx5PiFAwBNnnwkB2wi3BA7FFTLo/image.png)
虽然提示信息有些难以理解，但是我们还是可以得出API调用失败的结论。

其它的account_history以及market_history的API就不用试啦，没启用还想好用，做梦呢啊？


# 参考链接

* [开始同步节点数据](https://steemit.com/bitshares/@oflyhigh/5mqv5m)
* [尝试编译BitShares Core](https://steemit.com/bitshares/@oflyhigh/bitshares-core)

- - -

This page is synchronized from the post: [节点同步数据完成/ 内存、磁盘占用、运行应用、测试插件](https://steemit.com/@oflyhigh/6pqi4j)
