
---
title: '更新BitShares 节点版本至2.0.180328'
permlink: bitshares-2-0-180328
catalog: true
toc_nav_num: true
toc: true
date: 2018-03-30 02:34:54
categories:
- bitshares
tags:
- bitshares
- bts
- cn
- cn-programming
- study
thumbnail: https://steemitimages.com/DQmePaRrjS7QUeWJ8EUwn9xrCiRYV3wKjiv91kKN7RVDXMS/image.png
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---


昨天 @abit 在steemit发表了 [BitShares Core Release 2.0.180328 新版本发布](https://steemit.com/bitshares/@abit/bitshares-core-release-2-0-180328)，并提及**此版本修正了若干重大安全问题，请所有节点尽早升级**

![](https://steemitimages.com/DQmePaRrjS7QUeWJ8EUwn9xrCiRYV3wKjiv91kKN7RVDXMS/image.png)

上文中提到两点注意事项，一是[2.0.171212](https://github.com/bitshares/bitshares-core/releases/tag/2.0.171212)版本以后有了对libcurl-dev的依赖，这个因为我系统上以前就编译过[2.0.171212](https://github.com/bitshares/bitshares-core/releases/tag/2.0.171212)以后的版本，所以相关库我早就装完了，如果没有，则需运行以下指令：
>`sudo apt-get install libcurl4-openssl-dev`

另外一点是子模块远程URLs(submodule remote URLs)变动，如果更新原有的本地库，那么需要执行对应指令，对我而言，我把本地库丢一边，重新checkout一下好了。😀

# 重新编译
```
git clone https://github.com/bitshares/bitshares-core.git
cd bitshares-core
git checkout <LATEST_RELEASE_TAG>
git submodule update --init --recursive
mkdir build
cd build
cmake -DCMAKE_BUILD_TYPE=Release ..
make witness_node cli_wallet
```
新版本的版本号为[2.0.180328](https://github.com/bitshares/bitshares-core/releases/tag/2.0.180328)，所以<LATEST_RELEASE_TAG>处要做对应修改。

# 编译完成

大约1-2个小时后，编译完成(我的VPS配置一般啦）

我们会得到以下两个程序：
* build/programs/witness_node/witness_node
* build/programs/cli_wallet/cli_wallet

这时候有三个选择，

* 一个是用生成的文件覆盖原来的程序目录，然后运行witness_node，但这样会导致原来的节点在replay完成之前无法正常使用。
* 另外一种方法复制原本的程序目录，然后用新程序覆盖，在不同的端口上启动witness_node。
* 再有就是全新运行，这样需要较长的时间来从网络同步区块。

我选择第三种方法，之所以选择第三种方法，纯属闲的：）
(***比较一下生成区块链数据目录文件的大小***）

# 配置

除了关掉p2p日志，我好像也没做啥配置。

先运行一下程序，生成数据目录以及配置文件等
` ./witness_node`

然后在witness_node_data_dir的config.ini中注释掉这行：
>`filename=logs/p2p/p2p.log`

然后启动witness_node开始同步区块
>`./witness_node --rpc-endpoint "127.0.0.1:9090" --plugins "witness" --replay-blockchain`

因为8090端口已经被老的witness_node占用了，我先用9090，等同步好了，再改过来。

对了，执行指令之前先创建个screen虚拟终端
>`screen -S bts180328`

![](https://steemitimages.com/DQmUo7Lxn1K73jdn2fkvh31LPHzWujQk19dMByVn5VvH6n1/image.png)
嗯，就这样，慢慢同步吧。

# 相关链接

* [BitShares Core Release 2.0.180328 新版本发布 by @abit ](https://steemit.com/bitshares/@abit/bitshares-core-release-2-0-180328)
* [尝试编译BitShares Core](https://steemit.com/bitshares/@oflyhigh/bitshares-core)
* [开始同步节点数据](https://steemit.com/bitshares/@oflyhigh/5mqv5m)
* [节点同步数据完成/ 内存、磁盘占用、运行应用、测试插件](https://steemit.com/bitshares/@oflyhigh/6pqi4j)
* [更新了一下bitshares节点以及轻钱包](https://steemit.com/bitshares/@oflyhigh/7vyz83-bitshares)
* [测试了一下bitshares新API: get_account_history_by_operations (cli_wallet & rpc)](https://steemit.com/bitshares/@oflyhigh/bitshares-api-getaccounthistorybyoperations-cliwallet-and-rpc)

- - -

This page is synchronized from the post: [更新BitShares 节点版本至2.0.180328](https://steemit.com/@oflyhigh/bitshares-2-0-180328)
