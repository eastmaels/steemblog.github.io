
---
title: '烦人的502错误'
permlink: 502
catalog: true
toc_nav_num: true
toc: true
position: 9999
date: 2020-06-20 02:29:42
categories:
- cn
tags:
- cn
- nginx
- whalepower
- diy
- mini
- zzan
- dblog
- diamondtoken
- marlians
- upfundme
- actnearn
thumbnail: None
sidebar:
    right:
        sticky: true
widgets:
    -
        type: toc
        position: right
---


502错误对于steem.buzz的用户来说，应该不陌生，时不时会出现，并且需要清理缓存才能解决

一直以为是消息提醒服务的问题，但是昨天修复了消息提醒服务后还一直出现，而且症状奇怪

我的大号登陆没啥问题，但是换个账号登陆后，刷新一下页面502错误就出现了，清理了缓存又正常了

以为是cloudflare的缓存问题，暂时关闭cloudflare后，同样的502问题还是出现，最后只能是nginx的设置问题了

查了一下nginx的日志，果然问题出在nginx的设置上：

>2020/06/19 04:35:29 [error] 8#8: *13 upstream sent too big header while reading response header from upstream, client: 173.245.52.181, server: steem.buzz, request: "GET /created/wherein HTTP/1.1", upstream: "http://142.93.124.255:8080/created/wherein", host: "steem.buzz", referrer: "https://steem.buzz/created/wherein"


原因是：proxy是nginx作为client转发时使用的，如果header过大，超出了默认的1k，就会引发上面的upstream sent too big header问题

看了一下解决办法，在nginx配置文件上加上就解决了

 proxy_buffer_size          128k;
    proxy_buffers              4 256k;
    proxy_busy_buffers_size    256k;

重启nginx后，steem.buzz的502错误就消失了~ 少了一个烦人的问题

- - -

This page is synchronized from the post: ['烦人的502错误'](https://steemit.com/@ericet/502)
